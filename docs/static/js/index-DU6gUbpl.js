import{w as d,L as I}from"./element-plus-DqF3CFZt.js";import{T as z,r as w,d as B,e as F,c as L}from"./index-CQqWZ_uE.js";import{a as R}from"./axios-t--hEgTQ.js";import{r as f,b as j,u as i,w as A,n as E,Z as O,O as y,o as x,P,V as q,Y as K,H as M}from"./@vue-mkEhlmfj.js";import"./dayjs-NaOncrXL.js";import"./lodash-es-ClQ57oLH.js";import"./@element-plus-bIyKSLSo.js";import"./@sxzz-D_chPuIy.js";import"./@vueuse-rxiZlCUB.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-9PlIezaS.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./vue-router-BufAqlfE.js";import"./pinia-DpYkTtyU.js";import"./nprogress-BUPCWICh.js";/* empty css                      */import"./pinia-plugin-persistedstate-BQU3TZ4K.js";import"./destr-CVtkxrq9.js";import"./deep-pick-omit-CegYQlcN.js";import"./vue-echarts-HlqWhipj.js";import"./echarts-1ln0nKje.js";import"./zrender-BxIALAev.js";import"./tslib-BDyQ-Jie.js";import"./@iconify-6CJ1KTjM.js";function V(e){const a=localStorage.getItem(z);a&&(e.headers.authorization=a)}const S={webScsApi:"/web-scs-api",webCenterApi:"/web-center-api"},Y=e=>(V(e),e),D=e=>{if(e.status==200){if(console.log("asdfwe",e),e.data.code<400)return Promise.resolve(e);H(e.data)}return Promise.reject(e)},H=async e=>{const a=e==null?void 0:e.code;if(!a)return Promise.reject(e);switch(a){case 401:{d({message:"登录过期，请重新登录",type:"error"}),w.currentRoute.value.path!=="/login"&&(d.error("登录过期，请重新登录"),w.replace({path:"/login"}));break}case 404:d({message:"网络请求不存在",type:"error"});break;default:d({message:(e==null?void 0:e.msg)||"网络请求错误",type:"error"})}return Promise.reject(e)},T=e=>{const a=R.create({baseURL:e,timeout:3e4});return a.interceptors.request.use(Y),a.interceptors.response.use(D),a};T(S.webScsApi);T(S.webCenterApi);const U=e=>({rows:[{name:"admin",postCn:"管理员",sexCn:"男"}],total:0}),W=(e={})=>{const{api:a,searchInfo:l,listField:b="rows",afterFetch:p="",formatParams:c="",immediate:_=!0}=e,o=f({pageNum:1,pageSize:10,total:0}),r=f(!1),s=f(null),n=f([]),m=[],h=t=>{s.value?t():m.push(t)},v=()=>{E(()=>{m.forEach(t=>t()),m.length=0})},N=t=>{s.value=t,o.value.pageNum=t.params.pageNum,o.value.pageSize=t.params.pageSize,A([()=>t.params.pageNum,()=>t.params.pageSize],([u,C])=>{o.value.pageNum=u,o.value.pageSize=C,g()}),v()},g=async()=>{try{r.value=!0;let t={};c&&c instanceof Function?t=c(i(l)):t=i(l);const u=await a({...o.value,...t});n.value=u[b]||[],p&&p instanceof Function&&(n.value=p(n.value)),o.value.total=u.total||0,h(()=>{s.value.updateParams({total:u.total||0})})}catch(t){console.log(t)}finally{r.value=!1}},k=()=>{o.value.pageNum=1,s.value&&s.value.updateParams({pageNum:1}),g()};return j(()=>{_&&g()}),[N,{data:n,params:o,getList:g,reload:k,loading:r}]},Z={list:[{label:"名称",type:"input",prop:"name"},{label:"名344",type:"select",placeholder:"请选择你的值",prop:"test2",options:[{value:"1",label:"1"},{value:"2",label:"2"}]},{label:"名称1",type:"input",prop:"name1"},{label:"名称2",type:"input",prop:"name2"},{label:"名称3",type:"input",prop:"name3"},{label:"名称4",type:"input",prop:"name4"},{label:"名称5",type:"input",prop:"name5"}]},ve={__name:"index",setup(e){const a=[{type:"index",label:"序号",width:60},{label:"名字",prop:"name"},{label:"职位",prop:"postCn"},{label:"性别",prop:"sexCn"}],l=O({test:"1"}),b=r=>{Object.assign(l,r),o()},[p,{data:c,loading:_,reload:o}]=W({api:U,searchInfo:l});return(r,s)=>{const n=F,m=B,h=L,v=I;return x(),y(h,{class:"p-20px"},{default:P(()=>[q((x(),y(m,{onRegister:i(p),columns:a,data:i(c)},{header:P(()=>[K(n,M(i(Z),{onSearch:b}),null,16)]),_:1},8,["onRegister","data"])),[[v,i(_)]])]),_:1})}}};export{ve as default};
